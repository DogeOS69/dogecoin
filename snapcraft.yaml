# Dogecoin - Snapcraft Build - Known to build in most Ubuntu versions - WIP
# https://github.com/dogecoin/dogecoin
# https://github.com/carsenk/dogecoin
# By Carsen Klock
name: dogecoin
version: '1.0'
summary: Dogecoin
description: |
  Dogecoin such wow much cryptocurrency

grade: stable
confinement: strict

plugs: # plugs for theming, font settings, cursor and to use gtk3 file chooser
  gtk-3-themes:
    interface: content
    target: $SNAP/data-dir/themes
    default-provider: gtk-common-themes:gtk-3-themes
  icon-themes:
    interface: content
    target: $SNAP/data-dir/icons
    default-provider: gtk-common-themes:icon-themes
  sound-themes:
    interface: content
    target: $SNAP/data-dir/sounds
    default-provider: gtk-common-themes:sounds-themes
 
apps:
  dogecoind:
    command: bin/dogecoind
    plugs: [home, network, network-bind]
    daemon: forking
  daemon:
    command: bin/dogecoind
    plugs: [home, network, network-bind]
    environment:
      XDG_DATA_DIRS: $SNAP_USER_DATA:/var/lib/snapd/desktop:$XDG_DATA_DIRS
      # Override HOME so the datadir is located at
      # ~/snap/denarius/common/.denarius/ instead of
      # ~/snap/denarius/current/.denarius/, and each new version of the
      # snap won't have a different data directory:
      # https://docs.snapcraft.io/environment-variables/7983
      HOME: $SNAP_USER_COMMON
  dogecoin:
    command: desktop-launch $SNAP/bin/dogecoin-qt
    plugs: [home, network, network-bind, unity7, wayland, desktop-legacy, desktop, x11, gsettings]
    desktop: dogecoin.desktop
    environment:
      QT_QPA_PLATFORMTHEME: gtk3
      XDG_DATA_DIRS: $SNAP_USER_DATA:/var/lib/snapd/desktop:$XDG_DATA_DIRS
      HOME: $SNAP_USER_COMMON
 
parts:
  daemon:
    source: https://github.com/carsenk/dogecoin.git
    source-type: git
    source-tag: master
    plugin: nil
    build-packages:
      - g++
      - jq
      - wget
      - unzip
      - curl
      - build-essential
      - apt-transport-https
      - zlib1g-dev
      - libboost-all-dev
      - libqrencode-dev
      - libminiupnpc-dev
      - libevent-dev
      - libssl-dev
      - libtool
      - libdb5.1-dev 
      - libdb5.1++-dev
      - pkg-config
      - autotools-dev
      - automake
      - bsdmainutils
    stage-packages:
      - g++
      - jq
      - wget
      - unzip
      - curl
      - build-essential
      - apt-transport-https
      - zlib1g-dev
      - libboost-all-dev
      - libqrencode-dev
      - libminiupnpc-dev
      - libevent-dev
      - libssl-dev
      - libtool      
      - libdb5.1-dev 
      - libdb5.1++-dev
      - pkg-config
      - autotools-dev
      - automake
      - bsdmainutils
    override-build: |
      bash autogen.sh
      bash configure
      make -j4
      cp $SNAPCRAFT_PART_BUILD/src/dogecoind $SNAPCRAFT_PART_INSTALL/bin
  dogecoin:
    source: https://github.com/carsenk/dogecoin.git
    source-type: git
    source-tag: master
    plugin: qmake
    qt-version: qt5
    build-packages:
      - g++
      - jq
      - wget
      - unzip
      - curl
      - build-essential
      - apt-transport-https
      - zlib1g-dev
      - libboost-all-dev
      - libqrencode-dev
      - libminiupnpc-dev
      - libevent-dev
      - libssl-dev
      - libtool
      - libqt5gui5
      - libqt5core5a
      - libqt5dbus5
      - qttools5-dev
      - qttools5-dev-tools
      - qt5-default
      - qtbase5-dev-tools      
      - libdb5.1-dev 
      - libdb5.1++-dev
      - pkg-config
      - autotools-dev
      - automake
      - bsdmainutils
    stage-packages:
      - g++
      - jq
      - wget
      - unzip
      - curl
      - build-essential
      - apt-transport-https
      - zlib1g-dev
      - libboost-all-dev
      - libqrencode-dev
      - libminiupnpc-dev
      - libevent-dev
      - libssl-dev
      - libtool
      - libqt5gui5
      - libqt5core5a
      - libqt5dbus5
      - qttools5-dev
      - qttools5-dev-tools
      - qt5-default
      - qtbase5-dev-tools      
      - libdb5.1-dev 
      - libdb5.1++-dev
      - pkg-config
      - autotools-dev
      - automake
      - bsdmainutils
    override-build: |
      bash autogen.sh
      bash configure
      make -j4
      cp dogecoin-qt $SNAPCRAFT_PART_INSTALL/bin
    after: [desktop-qt5]
  desktop:
    source: snap/gui
    plugin: dump
  hooks:
    plugin: dump
    source: hooks/
    organize:
      bin/: snap/hooks/

hooks:
  install:
    plugs: [network, network-bind]
  post-refresh:
    plugs: [network, network-bind]
  configure:
    plugs: [network, network-bind]
